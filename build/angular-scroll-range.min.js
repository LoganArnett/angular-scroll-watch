/*! angular-scroll-range
version: 0.1.0
build date: 2014-8-17
author: Chih-Hsuan Fan
https://github.com/pc035860/angular-scroll-range.git */
!function(n){var t="srStyle",e="srWatch",r="srClass",i="srOn";n.controller("ScrollRangeCtrl",["$window","$document","$parse","$log","$rootScope",function(n,t,e,r,i){var o=this,s=angular.element(n),a=function(){return n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(t){n.setTimeout(t,1e3/60)}}(),c=function(){var n=t[0].documentElement,e=t[0].body;return Math.max(e.scrollHeight,n.scrollHeight,e.offsetHeight,n.offsetHeight,n.clientHeight)},l=function(){var e=t[0].documentElement.clientHeight,r=n.innerHeight;return e>r?r:e},u=function(){return n.pageYOffset},f=function(){function n(){var n,t,r,i=l(),a=c(),f=a-i,g=u();n=function(n){return f+n},t=function(n){return n-f},r=function(e){return e>0?t(e):n(e)},angular.forEach(o.configs,function(r){var i,o,a,c;i=r.lower<0?n(r.lower):r.lower,o=r.upper<0?n(r.upper):r.upper,i>g?(c=0,a={$positive:i,$negative:t(i)}):g>o?(c=1,a={$positive:o,$negative:t(o)}):g>=i&&o>=g&&(c=(g-i)/(o-i),a={$positive:g,$negative:t(g)}),a.$progress=c,a.$percentage=100*c,r._lastProgress&&r._lastProgress!==c?r._lastProgress>c?a.$direction=-1:r._lastProgress<c&&(a.$direction=1):a.$direction=0,r.styleGetter&&e(a,r),r.classGetter&&s(a,r),r.onGetterList&&d(a,r),r._lastProgress=c})}var t,e,s,f,g,d,p=/((?:>|<)?=?)\s*?((?:-(?!p))|(?:p(?!-)))?(\d+)/;return e=function(n,t){t.target.css(t.styleGetter(t.scope,n))},f=function(n,t){var e;angular.isObject(t)&&!angular.isArray(t)&&(e=[],angular.forEach(t,function(n,t){n&&e.push(t)}),t=e),t&&n.addClass(angular.isArray(t)?t.join(" "):t)},g=function(n,t){var e;angular.isObject(t)&&!angular.isArray(t)&&(e=[],angular.forEach(t,function(n,t){n&&e.push(t)}),t=e),n.removeClass(angular.isArray(t)?t.join(" "):t)},s=function(n,t){var e=t.classGetter(t.scope,n);t._oldClassVal&&!angular.equals(e,t._oldClassVal)&&g(t.target,t._oldClassVal),f(t.target,e),t._oldClassVal=e},d=function(n,t){var e=function(t){var e,i,o,s,a,c,l,u,f,g;return null===(e=t.match(p))?(r.warn("condition syntax error",t),!1):(c=function(n,t){return n==t},l=function(n,t){return t>n},u=function(n,t){return n>t},f=function(n,t){return t>=n},g=function(n,t){return n>=t},i={"=":c,"<":l,">":u,"<=":f,">=":g}[e[1]],o=e[2]||null,s=Number(e[3]),a="$positive","p"===o?a="$progress":"-"===o&&(a="$negative",s=-s),i(n[a],s))};angular.forEach(t.onGetterList,function(r){var o=e(r.condition);o&&o!==r.lastMatch&&(r.getter(t.scope,n),(t.localDigest?t.scope:i).$digest()),r.lastMatch=o})},t=!1,function(){t||(t=!0,a(function(){n(),t=!1}))}}();this._configId=0,this.configs=null,this.init=function(){this.configs={},s.bind("scroll",f).bind("resize",f),f()},this.addConfig=function(n){angular.forEach(["target","lower","upper"],function(t){if(angular.isUndefined(n[t]))throw new Error("`"+t+"` should be provided")}),this._configId++,n.styleExpr&&(n.styleGetter=e(n.styleExpr)),n.classExpr&&(n.classGetter=e(n.classExpr)),n.onExpr&&(n.localDigest=!!n.localDigest,n.onGetterList=[],angular.forEach(e(n.onExpr)({}),function(t,r){n.onGetterList.push({condition:r,getter:e(t),lastMatch:!1})})),this.configs[this._configId]=n},this.removeConfig=function(n){this.configs&&this.configs[n]&&delete this.configs[n]},this.destroy=function(){this.configs=null,s.unbind("scroll",f).unbind("resize",f)}}]).directive("scrollRange",function(){return{restrict:"A",controller:"ScrollRangeCtrl",link:{pre:function(n,o,s,a){a.init();var c;s[e]&&(s[t]||s[r]||s[i])&&(n.$watch(s[e],function(e){e&&angular.isObject(e)&&(c&&a.removeConfig(c),e.target=o,e.scope=n,s[t]&&(e.styleExpr=s[t]),s[r]&&(e.classExpr=s[r]),s[i]&&(e.onExpr=s[i]),c=a.addConfig(e))},!0),o.on("$destroy",function(){c&&a.removeConfig(c)})),o.on("$destroy",function(){a.destroy()})}}}}).directive(e,function(){return{require:"?^scrollRange",restrict:"A",link:function(n,o,s,a){if(!angular.isDefined(s.scrollRange)){var c;(s[t]||s[r]||s[i])&&(n.$watch(s[e],function(e){e&&angular.isObject(e)&&(c&&a.removeConfig(c),e.target=o,e.scope=n,s[t]&&(e.styleExpr=s[t]),s[r]&&(e.classExpr=s[r]),s[i]&&(e.onExpr=s[i]),c=a.addConfig(e))},!0),o.on("$destroy",function(){c&&a.removeConfig(c)}))}}}})}(angular.module("pc035860.scrollRange",[]));