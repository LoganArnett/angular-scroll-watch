/*! angular-scroll-range
version: 0.1.0
build date: 2014-8-17
author: Chih-Hsuan Fan
https://github.com/pc035860/angular-scroll-range.git */
!function(t){function n(t,n){var r=[];t:for(var e=0;e<t.length;e++){for(var i=t[e],o=0;o<n.length;o++)if(i==n[o])continue t;r.push(i)}return r}function r(t){if(angular.isArray(t))return t;if(angular.isString(t))return t.split(" ");if(angular.isObject(t)){var n=[];return angular.forEach(t,function(t,r){t&&(n=n.concat(r.split(" ")))}),n}return t}function e(t,n){if(angular.isArray(t)){n=n||[];for(var r=0;r<t.length;r++)n[r]=t[r]}else if(angular.isObject(t)){n=n||{};for(var e in t)!hasOwnProperty.call(t,e)||"$"===e.charAt(0)&&"$"===e.charAt(1)||(n[e]=t[e])}return n||t}var i="srStyle",o="srWatch",s="srClass",a="srOn";t.controller("ScrollRangeCtrl",["$window","$document","$parse","$log","$rootScope","$animate",function(t,i,o,s,a,c){var l=this,u=angular.element(t),f=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(n){t.setTimeout(n,1e3/60)}}(),g=function(){var t=i[0].documentElement,n=i[0].body;return Math.max(n.scrollHeight,t.scrollHeight,n.offsetHeight,t.offsetHeight,t.clientHeight)},d=function(){var n=i[0].documentElement.clientHeight,r=t.innerHeight;return n>r?r:n},h=function(){return t.pageYOffset},p=function(){function t(){var t,n,r,e=d(),i=g(),s=i-e,a=h();t=function(t){return s+t},n=function(t){return t-s},r=function(r){return r>0?n(r):t(r)},angular.forEach(l.configs,function(r){var e,i,s,c;e=r.lower<0?t(r.lower):r.lower,i=r.upper<0?t(r.upper):r.upper,e>a?(c=0,s={$positive:e,$negative:n(e)}):a>i?(c=1,s={$positive:i,$negative:n(i)}):a>=e&&i>=a&&(c=(a-e)/(i-e),s={$positive:a,$negative:n(a)}),s.$progress=c,s.$percentage=100*c,r._lastProgress&&r._lastProgress!==c?r._lastProgress>c?s.$direction=-1:r._lastProgress<c&&(s.$direction=1):s.$direction=0,r.styleGetter&&o(s,r),r.classGetter&&u(s,r),r.onGetterList&&E(s,r),r._lastProgress=c})}var i,o,u,p,v,$,m,E,C=/((?:>|<)?=?)\s*?((?:-(?!p))|(?:p(?!-)))?(\d+)/;return o=function(t,n){n.target.css(n.styleGetter(n.scope,t))},p=function(t,n){var r=t.attr,e=$(t,n,1);r.$addClass(e)},v=function(t,n){var r=t.attr,e=$(t,n,-1);r.$removeClass(e)},$=function(t,n,r){var e=t.target,i=e.data("$classCounts")||{},o=[];return angular.forEach(n,function(t){(r>0||i[t])&&(i[t]=(i[t]||0)+r,i[t]===+(r>0)&&o.push(t))}),e.data("$classCounts",i),o.join(" ")},m=function(t,r,e){var i=t.target,o=n(e,r),s=n(r,e);s=$(t,s,-1),o=$(t,o,1),0===o.length?c.removeClass(i,s):0===s.length?c.addClass(i,o):c.setClass(i,o,s)},u=function(t,n){var i=n.classGetter(n.scope,t),o=n._oldClassVal,s=r(i||[]);if(o){if(!angular.equals(i,o)){var a=r(o);m(n,a,s)}}else p(n,s);n._oldClassVal=e(i)},E=function(t,n){var r=function(n){var r,e,i,o,a,c,l,u,f,g;return null===(r=n.match(C))?(s.warn("condition syntax error",n),!1):(c=function(t,n){return t==n},l=function(t,n){return n>t},u=function(t,n){return t>n},f=function(t,n){return n>=t},g=function(t,n){return t>=n},e={"=":c,"<":l,">":u,"<=":f,">=":g}[r[1]],i=r[2]||null,o=Number(r[3]),a="$positive","p"===i?a="$progress":"-"===i&&(a="$negative",o=-o),e(t[a],o))};angular.forEach(n.onGetterList,function(e){var i=r(e.condition);i&&i!==e.lastMatch&&(e.getter(n.scope,t),(n.localDigest?n.scope:a).$digest()),e.lastMatch=i})},i=!1,function(){i||(i=!0,f(function(){t(),i=!1}))}}();this._configId=0,this.configs=null,this.init=function(){this.configs={},u.bind("scroll",p).bind("resize",p),p()},this.addConfig=function(t){angular.forEach(["target","lower","upper"],function(n){if(angular.isUndefined(t[n]))throw new Error("`"+n+"` should be provided")}),this._configId++,t.styleExpr&&(t.styleGetter=o(t.styleExpr)),t.classExpr&&(t.classGetter=o(t.classExpr)),t.onExpr&&(t.localDigest=!!t.localDigest,t.onGetterList=[],angular.forEach(o(t.onExpr)({}),function(n,r){t.onGetterList.push({condition:r,getter:o(n),lastMatch:!1})})),this.configs[this._configId]=t},this.removeConfig=function(t){this.configs&&this.configs[t]&&delete this.configs[t]},this.destroy=function(){this.configs=null,u.unbind("scroll",p).unbind("resize",p)}}]).directive("scrollRange",function(){return{restrict:"A",controller:"ScrollRangeCtrl",link:{pre:function(t,n,r,e){e.init();var c;r[o]&&(r[i]||r[s]||r[a])&&(t.$watch(r[o],function(o){o&&angular.isObject(o)&&(c&&e.removeConfig(c),o.target=n,o.scope=t,r[i]&&(o.styleExpr=r[i]),r[s]&&(o.classExpr=r[s],o.attr=r),r[a]&&(o.onExpr=r[a]),c=e.addConfig(o))},!0),n.on("$destroy",function(){c&&e.removeConfig(c)})),n.on("$destroy",function(){e.destroy()})}}}}).directive(o,function(){return{require:"?^scrollRange",restrict:"A",link:function(t,n,r,e){if(!angular.isDefined(r.scrollRange)){var c;(r[i]||r[s]||r[a])&&(t.$watch(r[o],function(o){o&&angular.isObject(o)&&(c&&e.removeConfig(c),o.target=n,o.scope=t,r[i]&&(o.styleExpr=r[i]),r[s]&&(o.classExpr=r[s],o.attr=r),r[a]&&(o.onExpr=r[a]),c=e.addConfig(o))},!0),n.on("$destroy",function(){c&&e.removeConfig(c)}))}}}})}(angular.module("pc035860.scrollRange",[]));